<h1><code ng:non-bindable=""></code>
<span class="hint"></span>
</h1>
<div><h2 id="gettingstarted">Getting started</h3>

<p>To use the SDK, you need to</p>

<ol>
<li><p>init the SDK; e.g., (<a href="#/api/init.functions:init">all options</a>)
<pre class="prettyprint linenums">
FamilySearch.init({
  app_key: 'YOUR_ACCESS_KEY_GOES_HERE',
  environment: 'sandbox',
  // auth_callback is the URI you registered with FamilySearch;
  // the page does not need to exist but it must have the same host and port
  // as the server running your script
  auth_callback: 'REDIRECT_GOES_HERE',
  http_function: jQuery.ajax,
  deferred_function: jQuery.Deferred
});
</pre></li>
<li><p>get an access token; e.g.,
<pre class="prettyprint linenums">
FamilySearch.getAccessToken().then(function(response) {
   // now you have an access token
});
</pre></li>
<li><p>make API calls; e.g.,
<pre class="prettyprint linenums">
FamilySearch.getCurrentUser().then(function(response) {
   // now you have the response
});
</pre></li>
</ol>

<h3 id="example">Example</h4>

<pre class="prettyprint linenums">
FamilySearch.init({
  app_key: 'MY_ACCESS_KEY',
  environment: 'sandbox',
  auth_callback: 'http://localhost/auth',
  http_function: $.ajax,
  deferred_function: $.Deferred,
});

FamilySearch.getAccessToken().then(function(accessToken) {
  FamilySearch.getCurrentUser().then(function(response) {
    var user = response.getUser();
    console.log('Hello '+user.contactName);
  });
});
</pre>

<h2 id="promises">Promises</h3>

<p>Most functions return promises.
The promises are generated by the <code>deferred_function</code> you passed into the <code>init</code> call.
If the promise is fulfilled, it will return a single parameter containing the response data.
If the response is rejected, it will return whatever the <code>http_function</code> passed into the <code>init</code> call returns.</p>

<p>The following functions are also available on the promise</p>

<ul>
<li><code>getResponseHeader(header)</code></li>
<li><code>getAllResponseHeaders()</code></li>
<li><code>getStatusCode()</code></li>
</ul>

<h3 id="examples">Examples</h4>

<h4 id="jquery">jQuery</h5>

<p>Requires jQuery 1.8 or later.</p>

<p>If you pass <code>jQuery.ajax</code> and <code>jQuery.Deferred</code> into the <code>FamilySearch.init</code> call, the returned promises
will have the the methods <a href="http://api.jquery.com/Types/#Promise">described here</a>; for example</p>

<ul>
<li><code>then(function(data) {}, function(jqXHR, textStatus, errorThrown) {})</code></li>
<li><code>done(function(data) {})</code></li>
<li><code>fail(function(jqXHR, textStatus, errorThrown) {})</code></li>
</ul>

<h4 id="angularjsnotyetimplemented">AngularJS -- not yet implemented</h5>

<p>If you pass <code>$http</code> and <code>$q.defer</code> into the <code>FamilySearch.init</code> call, the returned promises
will have the methods <a href="http://docs.angularjs.org/api/ng.$q#description_the-promise-api">described here</a>; for example</p>

<ul>
<li><code>then(function(data) {}, function({data: data, status: status, headers: headers, config: config}) {})</code></li>
<li><code>catch(function(data, status, headers, config) {})</code></li>
</ul>

<h4 id="nodejsnotyetimplemented">Node.js -- not yet implemented</h5>

<h2 id="handlingresponses">Handling responses</h3>

<p>API responses are typically json objects. The API calls add <em>convenience functions</em> for returning various objects from the response.
For example, the <code>getPerson('ID')</code> API call adds a <code>getPerson()</code> convenience function to return the
<a href="#/api/person.types:type.Person">Person</a> object from the response.</p>

<p>The returned objects contain the same properties as the original response json, but they have custom constructors whose
prototypes have additional convenience functions.
For example, the prototypes for <a href="#/api/person.types:type.Person">Person</a> objects have <code>getGivenName()</code> and <code>getSurname()</code>
convenience functions for returning the person's given name and surname respectively.
The object properties and convenience functions are fully described in the docs.</p>

<p>You can add your own convenience functions to the returned objects.
For example, suppose you wanted to display someone's name followed by their id. You would write
<pre class="prettyprint linenums">
  FamilySearch.Person.prototype.getNameAndId = function() {
    return this.getName() + ' (' + this.id + ')';
  }
</pre>

<p>and from then on you could call <code>person.getNameAndId()</code> on any <a href="#/api/person.types:type.Person">Person</a> object.</p>

<pre class="prettyprint linenums">
FamilySearch.getPerson('ID').then(function(response) {
  var person = response.getPerson();
  console.log('Hello '+person.getNameAndId());
});
</pre>

<h2 id="plumbing">Plumbing</h3>

<p>The functions in the <em>plumbing</em> module are low-level functions that you would not normally call.
The higher-level API functions that you normally call are built on top of the plumbing functions.
The plumbing functions are exposed in case you want to do something not anticipated by the API functions.
The plumbing functions here serve the same purpose as the
<a href="https://www.kernel.org/pub/software/scm/git/docs/#_low_level_commands_plumbing">plumbing functions in git</a>.</p>

<p>Note that promises returned by plumbing functions return whatever the <code>http_function</code> passed into the
<code>init</code> call returns.</p></div>
